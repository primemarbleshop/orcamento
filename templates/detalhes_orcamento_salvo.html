<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Orçamento Salvo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fc;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .card-custom {
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: none;
        }
        
        .card-header-custom {
            background: linear-gradient(135deg, #4e73df 0%, #2a3d8f 100%);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            padding: 15px 20px;
        }
        
        .btn-custom-primary {
            background-color: #4e73df;
            border-color: #4e73df;
            color: white;
        }
        
        .info-section {
            background-color: #f8f9fc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .info-row {
            display: flex;
            margin-bottom: 10px;
            border-bottom: 1px solid #e3e6f0;
            padding-bottom: 10px;
        }
        
        .info-label {
            font-weight: bold;
            width: 150px;
            color: #4e73df;
        }
        
        .info-value {
            flex: 1;
        }
        
        .table th {
            background: linear-gradient(135deg, #4e73df 0%, #2a3d8f 100%);
            color: white;
            vertical-align: middle;
        }
        
        .valor-total {
            font-weight: bold;
            color: #000000;
        }
        
        .page-header {
            border-bottom: 1px solid #e3e6f0;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            body {
                background-color: white;
            }
            
            .card-custom {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <!-- Cabeçalho -->
        <div class="page-header">
            <div class="row align-items-center">
                <div class="col">
                    <h1 class="h3 text-gray-800"><i class="fas fa-file-invoice me-2"></i>Detalhes do Orçamento</h1>
                </div>
                <div class="col-auto no-print">
                    <a href="/orcamentos_salvos" class="btn btn-custom-primary">
                        <i class="fas fa-arrow-left me-1"></i> Voltar
                    </a>
                    <button class="btn btn-success" onclick="window.print()">
                        <i class="fas fa-print me-1"></i> Imprimir
                    </button>
                </div>
            </div>
        </div>

        <!-- Card de detalhes do orçamento -->
        <div class="card card-custom">
            <div class="card-header card-header-custom">
                <h5 class="m-0 font-weight-bold"><i class="fas fa-info-circle me-2"></i>Informações do Orçamento</h5>
            </div>
            <div class="card-body">
                <!-- Informações do orçamento -->
                <div class="info-section">
                    <div class="info-row">
                        <span class="info-label">Código:</span>
                        <span class="info-value">{{ codigo_orcamento }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Data:</span>
                        <span class="info-value">{{ data_salvo.strftime('%d/%m/%Y às %H:%M') }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Cliente:</span>
                        <span class="info-value">{{ cliente_nome }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">CNPJ/CPF:</span>
                        <span class="info-value">{{ orcamentos[0].cliente.documento if orcamentos else "Não informado" }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Telefone:</span>
                        <span class="info-value">{{ telefone_usuario }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Endereço:</span>
                        <span class="info-value">{{ orcamentos[0].cliente.endereco if orcamentos and orcamentos[0].cliente.endereco else "Não informado" }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Valor Total:</span>
                        <span class="info-value valor-total">{{ valor_total_final }}</span>
                    </div>
                </div>

                <!-- Itens do orçamento -->
                <h5 class="mb-3"><i class="fas fa-list me-2"></i>Itens do Orçamento</h5>
                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Produto</th>
                                <th>Material</th>
                                <th>Quantidade</th>
                                <th>Dimensões</th>
                                <th>Valor Unitário</th>
                                <th>Valor Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for orcamento in orcamentos %}
                            <tr>
                                <td>{{ orcamento.tipo_produto }}</td>
                                <td>{{ orcamento.material.nome }}</td>
                                <td>{{ orcamento.quantidade }}</td>
                                <td>
                                    {% if orcamento.tipo_produto == 'Nicho' %}
                                        {{ "%.2f"|format(orcamento.comprimento) }}cm x {{ "%.2f"|format(orcamento.largura) }}cm x {{ "%.2f"|format(orcamento.profundidade_nicho) }}cm
                                    {% else %}
                                        {{ "%.2f"|format(orcamento.comprimento) }}cm x {{ "%.2f"|format(orcamento.largura) }}cm
                                    {% endif %}
                                </td>
                                <td>R$ {{ "%.2f"|format(orcamento.valor_total / orcamento.quantidade) }}</td>
                                <td class="valor-total">R$ {{ "%.2f"|format(orcamento.valor_total) }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
</body>
</html>
