<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes dos Or√ßamentos</title>
   <style>
    
    /* Reduzir tamanho geral das fontes para 80% do original */
    body {
        font-size: 15px; /* Antes era 16px, agora reduzido 20% */
    }

    /* Reduzindo tamanho das tabelas */
    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 15px; /* Redu√ß√£o de 20% */
    }

    th, td {
        border: 1px solid black;
        padding: 3px; /* Redu√ß√£o leve do espa√ßamento */
        text-align: left;
    }

    th {
        background-color: #f2f2f2;
        font-size: 14px; /* Mantendo maior que o texto normal */
    }

    /* Reduzindo cabe√ßalhos do cliente */
    .cliente-header {
        font-size: 15px; /* Antes era 20px, agora 16px */
        font-weight: bold;
        margin-top: 14px;
        margin-bottom: 7px;
    }

    /* Reduzindo cabe√ßalhos de produtos */
    .produto-header {
        font-size: 15px; /* Antes era 18px, agora 15px */
        font-weight: bold;
        margin-top: 12px;
        margin-bottom: 6px;
    }

    /* Reduzir tamanho do bot√£o de impress√£o */
    .print-button {
        font-size: 14px; /* Antes era 16px */
        padding: 8px;
    }

  

    /* Reduzindo informa√ß√µes do cliente */
    .cliente-info {
        font-size: 13px;
        color: #555;
        font-weight: normal;
    }


.header-container {
    display: flex;
    justify-content: flex-start; /* Mant√©m o t√≠tulo alinhado √† esquerda */
    align-items: center; /* Alinha verticalmente */
    position: relative; /* Define um contexto para posicionar a logo */
    width: 100%; /* Ocupa toda a largura dispon√≠vel */
}

.logo-empresa {
    position: absolute;
    right: 0; /* Move a logo totalmente para o canto direito */
    top: 80px; /* Centraliza verticalmente em rela√ß√£o ao t√≠tulo */
    transform: translateY(-50%); /* Ajuste fino para centralizar exatamente */
    height: 150px; /* Ajuste conforme necess√°rio */
    width: auto; /* Mant√©m a propor√ß√£o */
}
.total-box {
    display: inline-block; /* Faz a largura se ajustar ao conte√∫do */
    background-color: #f8f9fa;
    border: 2px solid #000;
    padding: 8px 12px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 5px;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
    text-align: center;
    margin-bottom: 10px; /* Espa√ßo antes da tabela */
    float: right; /* Move a caixa para o lado direito */
} 
       
.cliente-header h2,
.cliente-header p {
    display: flex;
    align-items: flex-start;
    margin: 3px 0;
}

.cliente-header strong {
    white-space: nowrap;
    margin-right: 5px;
}

.wrap-text {
    display: inline-block;
    max-width: 75%;
    word-wrap: break-word;
}
@media print {
    @page {
       margin: 5mm; /* Margens reduzidas para melhor aproveitamento */
    }

    /* Ajusta a logo para impress√£o */
    .logo-empresa {
        position: absolute;
        top: 5mm;
        right: 10mm;
        height: 120px !important;
        width: auto !important;
    }

      
       body {
            margin: 0;
            padding: 0;
        }

    /* Evita que t√≠tulos sejam separados */
    .produto-header, .cliente-header {
        page-break-after: avoid;
        font-weight: bold;
        font-size: 14px;
    }

    /* Permite quebra de tabelas, se necess√°rio */
    table {
        page-break-inside: auto !important;
        width: 100%;
    }

    th, td {
        border: 1px solid black;
        padding: 4px;
        text-align: left;
        font-size: 10px; /* üî• Fonte menor nas c√©lulas */
    }

    /* Evita que o total seja separado do conte√∫do */
    .total-box {
        font-size: 14px !important;
        padding: 6px !important;
        page-break-before: avoid; /* Mant√©m o total sempre na mesma p√°gina */
        page-break-after: avoid;
    }

    
    /* Evita separa√ß√£o de cliente e produtos */
    .cliente-header {
        page-break-after: avoid;
        font-weight: bold;
        font-size: 14px;
    }

    /* Oculta bot√µes e links na impress√£o */
    .print-button, .btn-voltar {
        display: none !important;
    }
}

.cliente-header h2,
    .cliente-header p {
        display: block !important; /* Troque flex por block */
        margin: 3px 0 !important;
    }

    .cliente-header strong {
        display: inline !important;
        white-space: nowrap !important;
    }

    .wrap-text {
        display: inline-block !important;
        max-width: 60% !important;
        word-wrap: break-word !important;
        vertical-align: top !important;
    }
}
  


.header-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0; /* Remove espa√ßo extra */
}

h1, h2, h3, p {
    margin: 0; /* Remove qualquer margem extra */
    padding: 0; /* Remove espa√ßamentos internos */
    line-height: 1.2; /* Ajusta a altura da linha para reduzir espa√ßos verticais */
}

.empresa-header, .cliente-header {
    margin-bottom: 5px; /* Mant√©m um pequeno espa√ßamento */
}

.empresa-header h1, .cliente-header h2 {
    font-size: 18px; /* Define o mesmo tamanho para os t√≠tulos */
    margin-bottom: 3px; /* Reduz o espa√ßo abaixo do t√≠tulo */
    font-weight: bold;
}

p strong {
    font-weight: bold; /* Mant√©m o r√≥tulo em negrito */
}

.info-normal {
    font-weight: normal; /* Remove o negrito dos dados do cliente */
}

.detalhes-orcamento {
    margin-top: 5px; /* Reduz espa√ßo antes do t√≠tulo "Detalhes do Or√ßamento" */
}
</style>
</head>
<body>
<div class="header-container">
    <img src="{{ logo_url }}" alt="Logo da Empresa" class="logo-empresa">
</div>

<div class="empresa-header">
    <h1>Prime Marble Shop</h1>
    <p><strong>Endere√ßo:</strong> Estrada do Engenho, 1800 - Bangu</p>
    <p><strong>CNPJ:</strong> 39.903.780/0001-15</p>
    <!-- ADICIONANDO O TELEFONE DO USU√ÅRIO AQUI -->
    <p><strong>Telefone:</strong> <span class="info-normal">{{ telefone_usuario }}</span></p>
</div>

<div class="cliente-header">
    <h2>
        <strong>Cliente:</strong>
        <span class="wrap-text">{{ cliente_nome }}</span>
    </h2>
    <p>
        <strong>Endere√ßo:</strong>
        <span class="wrap-text info-normal">{{ orcamentos[0].cliente.endereco }}</span>
    </p>
    <p>
        <strong>Telefone:</strong>
        <span class="info-normal">{{ orcamentos[0].cliente.telefone }}</span>
    </p>
</div>


<h2>Detalhes do Or√ßamento</h2>
<p class="orcamento-info">
    <strong>Or√ßamento:</strong> {{ codigo_orcamento }}<br>
    <strong>Data:</strong> {{ data_salvo.strftime('%d/%m/%Y') }}
</p>
<div class="total-box">
    Valor Total: <span id="valorTotal">{{ valor_total_final }}</span>
    </div>


<br>

{% set tipos_produtos = {} %}

{% for orcamento in orcamentos %}
    {% if orcamento.tipo_produto not in tipos_produtos %}
        {% set tipos_produtos = tipos_produtos.update({orcamento.tipo_produto: []}) or tipos_produtos %}
    {% endif %}
    {% set _ = tipos_produtos[orcamento.tipo_produto].append(orcamento) %}
{% endfor %}

{% for tipo, produtos in tipos_produtos.items() %}
    <div class="produto-header"> {{ tipo }}</div>
    <table>
        <thead>
            <tr>
                <th>Material</th>
                <th>Qtd</th>
                <th>Comp.</th>
                <th>Larg.</th>
                {% if tipo in ["Bancada", "Lavatorio", "Ilharga", "Ilharga Bipolida"] %}
                <th>Saia</th>
                {% endif %}
                {% if tipo in ["Bancada", "Lavatorio"] %}
                <th>Fronte</th>
                {% endif %}
                {% if tipo in ["Bancada", "Lavatorio"] %}
                <th>Cuba</th>
                {% endif %}
                {% if tipo == "Bancada" %}
                <th>Cooktop</th>
                {% endif %}
                {% if tipo in ["Nicho", "Nicho Sem Fundo"] %}
                <th>Profundidade</th>
                <th>Fundo</th>
                <th>Alisar</th>
                <th>Larg. do Alisar</th>
                {% endif %}
                <th>Outros Custos</th>
                <th>Valor</th>
            </tr>
        </thead>
        <tbody>
            {% for produto in produtos %}
            <tr>
                <td>{{ produto.material.nome }}</td>
                <td>{{ produto.quantidade }}</td>
                <td>{{ produto.comprimento }} cm</td>
                <td>{{ produto.largura }} cm</td>
                {% if tipo in ["Bancada", "Lavatorio", "Ilharga", "Ilharga Bipolida"] %}
                <td>{{ produto.comprimento_saia }} x {{ produto.largura_saia }} cm</td>
                {% endif %}
                {% if tipo in ["Bancada", "Lavatorio"] %}
                <td>{{ produto.comprimento_fronte }} x {{ produto.largura_fronte }} cm</td>
                {% endif %}
                {% if tipo in ["Bancada", "Lavatorio"] %}
                <td>
                    {% if produto.tipo_cuba == "Esculpida" %}
                        Esculpida ({{ produto.quantidade_cubas }}) - {{ produto.comprimento_cuba }} x {{ produto.largura_cuba }} x {{ produto.profundidade_cuba }} cm
                    {% elif produto.tipo_cuba %}
                        {{ produto.tipo_cuba }} ({{ produto.quantidade_cubas }})
                    {% else %}
                        -
                    {% endif %}
                </td>
                {% endif %}
                {% if tipo == "Bancada" %}
                <td>{% if produto.tem_cooktop == "Sim" %}Sim{% else %}-{% endif %}</td>
                {% endif %}
                {% if tipo in ["Nicho", "Nicho Sem Fundo"] %}
                <td>{{ produto.profundidade_nicho }} cm</td>
                <td>{% if produto.tem_fundo == "Sim" %}Sim{% else %}N√£o{% endif %}</td>
                <td>{% if produto.tem_alisar == "Sim" %}Sim{% else %}N√£o{% endif %}</td>
                <td>{% if produto.tem_alisar == "Sim" %}{{ produto.largura_alisar }} cm{% else %}-{% endif %}</td>
                {% endif %}
                <td>R$ {{ "%.2f"|format(produto.outros_custos) }}</td>
                <td class="valor-tabela">R$ {{ "%.2f"|format(produto.valor_total) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endfor %}

<br>

<!-- Bot√£o de impress√£o -->
{% if not pdf %}
    <!--<button class="print-button" onclick="window.print()">Imprimir</button> -->
    </br>
    <button onclick="window.location.href='/gerar_pdf_orcamento/{{ codigo_orcamento }}'">Gerar PDF</button>
    </br>
    </br>
    <h2><a href="/orcamentos_salvos" class="btn-voltar">Voltar para Or√ßamentos Salvos</a></h2>
{% endif %}
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>    
</br>
</br>

    
</body>
</html>
