<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes dos Or√ßamentos - Prime Marble Shop</title>
    <style>
        :root {
            --primary-black: #000000;
            --primary-yellow: #FFD700;
            --secondary-yellow: #FFED85;
            --light-gray: #f5f5f5;
            --white: #ffffff;
            --dark-text: #333333;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
            color: var(--dark-text);
            line-height: 1.4;
            margin: 0;
            padding: 15px;
            background-color: var(--white);
        }
        
        /* Container principal */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--white);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        /* Cabe√ßalho com cores da empresa */
        .header {
            background: var(--primary-black);
            color: var(--white);
            padding: 20px;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .company-info {
            flex: 1;
        }
        
        .company-info h1 {
            color: var(--primary-yellow);
            margin: 0 0 10px 0;
            font-size: 24px;
        }
        
        .company-info p {
            margin: 4px 0;
            font-size: 13px;
        }
        
        .logo-container {
            text-align: right;
        }
        
        .logo-empresa {
            height: 100px;
            width: auto;
            max-width: 200px;
        }
        
        /* Informa√ß√µes do cliente */
        .client-info {
            background: var(--light-gray);
            padding: 15px 20px;
            border-left: 4px solid var(--primary-yellow);
        }
        
        .client-info h2 {
            color: var(--primary-black);
            margin: 0 0 10px 0;
            font-size: 18px;
            display: flex;
            align-items: center;
        }
        
        .client-info h2:before {
            content: "üë§";
            margin-right: 8px;
        }
        
        .client-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 8px;
        }
        
        .client-detail {
            display: flex;
        }
        
        .client-detail strong {
            min-width: 70px;
            color: var(--primary-black);
        }
        
        /* Informa√ß√µes do or√ßamento */
        .budget-info {
            padding: 15px 20px;
            background: var(--secondary-yellow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .budget-details {
            font-size: 14px;
        }
        
        .budget-details strong {
            color: var(--primary-black);
        }
        
        .total-box {
            background: var(--primary-black);
            color: var(--primary-yellow);
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* Tabelas de produtos */
        .products-section {
            padding: 15px 20px;
        }
        
        .product-type-header {
            background: var(--primary-black);
            color: var(--primary-yellow);
            padding: 8px 12px;
            margin: 15px 0 10px 0;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        th {
            background: var(--primary-yellow);
            color: var(--primary-black);
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .valor-tabela {
            font-weight: bold;
            color: var(--primary-black);
        }
        
        /* Bot√µes de a√ß√£o */
        .action-buttons {
            padding: 15px 20px;
            text-align: center;
            background: var(--light-gray);
            border-top: 1px solid #ddd;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 0 10px;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary-black);
            color: var(--primary-yellow);
        }
        
        .btn-primary:hover {
            background: #333;
        }
        
        .btn-secondary {
            background: var(--primary-yellow);
            color: var(--primary-black);
        }
        
        .btn-secondary:hover {
            background: #e6c200;
        }
        
        /* Estilos para impress√£o */
        @media print {
            @page {
                margin: 10mm;
            }
            
            body {
                padding: 0;
                font-size: 12px;
                background: white;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            
            .action-buttons, .btn {
                display: none !important;
            }
            
            .header {
                padding: 10mm 0 5mm 0;
                background: white !important;
                color: black !important;
            }
            
            .company-info h1 {
                color: black !important;
            }
            
            .logo-empresa {
                height: 80px;
            }
            
            .client-info {
                background: white !important;
                border-left: 2px solid black;
            }
            
            .budget-info {
                background: white !important;
                border-bottom: 2px solid var(--primary-yellow);
            }
            
            .total-box {
                background: black !important;
                color: yellow !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .product-type-header {
                background: black !important;
                color: yellow !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            th {
                background: yellow !important;
                color: black !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            table {
                page-break-inside: avoid;
            }
            
            .product-type-header {
                page-break-after: avoid;
            }
        }
        
        /* Ajuste para textos longos */
        .wrap-text {
            word-break: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Cabe√ßalho com logo e informa√ß√µes da empresa -->
        <div class="header">
            <div class="company-info">
                <h1>Prime Marble Shop</h1>
                <p><strong>Endere√ßo:</strong> Estrada do Engenho, 1800 - Bangu</p>
                <p><strong>CNPJ:</strong> 39.903.780/0001-15</p>
                <p><strong>Telefone:</strong> (21) 99999-9999</p>
            </div>
            <div class="logo-container">
                <img src="{{ logo_url }}" alt="Logo da Empresa" class="logo-empresa">
            </div>
        </div>
        
        <!-- Informa√ß√µes do cliente -->
        <div class="client-info">
            <h2>Cliente</h2>
            <div class="client-details">
                <div class="client-detail">
                    <strong>Nome:</strong>
                    <span class="wrap-text">{{ cliente_nome }}</span>
                </div>
                <div class="client-detail">
                    <strong>Endere√ßo:</strong>
                    <span class="wrap-text">{{ orcamentos[0].cliente.endereco }}</span>
                </div>
                <div class="client-detail">
                    <strong>Telefone:</strong>
                    <span>{{ orcamentos[0].cliente.telefone }}</span>
                </div>
                <div class="client-detail">
                    <strong>Documento:</strong>
                    <span>{{ orcamentos[0].cliente.documento }}</span>
                </div>
            </div>
        </div>
        
        <!-- Informa√ß√µes do or√ßamento -->
        <div class="budget-info">
            <div class="budget-details">
                <p><strong>Or√ßamento:</strong> {{ codigo_orcamento }}</p>
                <p><strong>Data:</strong> {{ data_salvo.strftime('%d/%m/%Y') }}</p>
            </div>
            <div class="total-box">
                Valor Total: {{ valor_total_final }}
            </div>
        </div>
        
        <!-- Produtos por tipo -->
        <div class="products-section">
            {% set tipos_produtos = {} %}
            {% for orcamento in orcamentos %}
                {% if orcamento.tipo_produto not in tipos_produtos %}
                    {% set tipos_produtos = tipos_produtos.update({orcamento.tipo_produto: []}) or tipos_produtos %}
                {% endif %}
                {% set _ = tipos_produtos[orcamento.tipo_produto].append(orcamento) %}
            {% endfor %}
            
            {% for tipo, produtos in tipos_produtos.items() %}
                <div class="product-type-header">{{ tipo }}</div>
                <table>
                    <thead>
                        <tr>
                            <th>Material</th>
                            <th>Qtd</th>
                            <th>Comp.</th>
                            <th>Larg.</th>
                            {% if tipo in ["Bancada", "Lavatorio", "Ilharga", "Ilharga Bipolida"] %}
                            <th>Saia</th>
                            {% endif %}
                            {% if tipo in ["Bancada", "Lavatorio"] %}
                            <th>Fronte</th>
                            {% endif %}
                            {% if tipo in ["Bancada", "Lavatorio"] %}
                            <th>Cuba</th>
                            {% endif %}
                            {% if tipo == "Bancada" %}
                            <th>Cooktop</th>
                            {% endif %}
                            {% if tipo in ["Nicho", "Nicho Sem Fundo"] %}
                            <th>Profund.</th>
                            <th>Fundo</th>
                            <th>Alisar</th>
                            {% endif %}
                            <th>Outros Custos</th>
                            <th>Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for produto in produtos %}
                        <tr>
                            <td>{{ produto.material.nome }}</td>
                            <td>{{ produto.quantidade }}</td>
                            <td>{{ produto.comprimento }} cm</td>
                            <td>{{ produto.largura }} cm</td>
                            {% if tipo in ["Bancada", "Lavatorio", "Ilharga", "Ilharga Bipolida"] %}
                            <td>
                                {% if produto.comprimento_saia or produto.largura_saia %}
                                    {{ produto.comprimento_saia }} x {{ produto.largura_saia }} cm
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            {% endif %}
                            {% if tipo in ["Bancada", "Lavatorio"] %}
                            <td>
                                {% if produto.comprimento_fronte or produto.largura_fronte %}
                                    {{ produto.comprimento_fronte }} x {{ produto.largura_fronte }} cm
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            {% endif %}
                            {% if tipo in ["Bancada", "Lavatorio"] %}
                            <td>
                                {% if produto.tipo_cuba == "Esculpida" %}
                                    Esculpida ({{ produto.quantidade_cubas }}) - {{ produto.comprimento_cuba }} x {{ produto.largura_cuba }} x {{ produto.profundidade_cuba }} cm
                                {% elif produto.tipo_cuba %}
                                    {{ produto.tipo_cuba }} ({{ produto.quantidade_cubas }})
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            {% endif %}
                            {% if tipo == "Bancada" %}
                            <td>{% if produto.tem_cooktop == "Sim" %}Sim{% else %}-{% endif %}</td>
                            {% endif %}
                            {% if tipo in ["Nicho", "Nicho Sem Fundo"] %}
                            <td>{{ produto.profundidade_nicho }} cm</td>
                            <td>{% if produto.tem_fundo == "Sim" %}Sim{% else %}N√£o{% endif %}</td>
                            <td>{% if produto.tem_alisar == "Sim" %}Sim ({{ produto.largura_alisar }} cm){% else %}N√£o{% endif %}</td>
                            {% endif %}
                            <td>R$ {{ "%.2f"|format(produto.outros_custos) }}</td>
                            <td class="valor-tabela">R$ {{ "%.2f"|format(produto.valor_total) }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endfor %}
        </div>
        
        <!-- Bot√µes de a√ß√£o -->
        {% if not pdf %}
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="window.print()">Imprimir</button>
            <button class="btn btn-secondary" onclick="window.location.href='/gerar_pdf_orcamento/{{ codigo_orcamento }}'">Gerar PDF</button>
            <a href="/orcamentos_salvos" class="btn btn-primary">Voltar para Or√ßamentos Salvos</a>
        </div>
        {% endif %}
    </div>
</body>
</html>
